# Copyright (c) Microsoft Corporation. All rights reserved.
# Licensed under the MIT license.

cmake_minimum_required(VERSION 3.12)

project(ZLIB VERSION 1.2.11 LANGUAGES CXX C)

if(MSVC)
    set(ZLIB_BINARY_DIR ${CMAKE_CURRENT_LIST_DIR}/zlib-build/${ZLIB_PLATFORM})
else()
    set(ZLIB_BINARY_DIR ${CMAKE_CURRENT_LIST_DIR}/zlib-src)
endif()

include(ExternalProject)
ExternalProject_Add(zlib_external
    GIT_REPOSITORY    https://github.com/madler/zlib.git
    GIT_TAG           v1.2.11
    SOURCE_DIR        ${CMAKE_CURRENT_LIST_DIR}/zlib-src
    BINARY_DIR        ${ZLIB_BINARY_DIR}
    CMAKE_ARGS        -DCMAKE_BUILD_TYPE=Release -DCMAKE_POSITION_INDEPENDENT_CODE=ON -DSKIP_INSTALL_ALL=ON -DCMAKE_TOOLCHAIN_FILE=${CMAKE_TOOLCHAIN_FILE} -DANDROID_ABI=${ANDROID_ABI} -DANDROID_NDK=${ANDROID_NDK} -DANDROID_PLATFORM=${ANDROID_PLATFORM} -DCMAKE_ANDROID_ARCH_ABI=${CMAKE_ANDROID_ARCH_ABI} -DCMAKE_ANDROID_NDK=${CMAKE_ANDROID_NDK} -DCMAKE_MAKE_PROGRAM=${CMAKE_MAKE_PROGRAM} -DCMAKE_SYSTEM_NAME=${CMAKE_SYSTEM_NAME} -DCMAKE_SYSTEM_VERSION=${CMAKE_SYSTEM_VERSION}
    INSTALL_COMMAND   ""
    TEST_COMMAND      ""
)
# -DCMAKE_C_COMPILER=${CMAKE_C_COMPILER}